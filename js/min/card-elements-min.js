function createCardText(e,t){var r="";if("top10"===e.type||"bottom10"===e.type){var a="{{comparitor}} {{action_pl}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b>",o="{{comparitor}} {{action_pp}} {{property}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b>",i="{{comparitor}} {{objects}} {{action_pl}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b>",n="{{value}} {{action_pl}} to {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b>",s='{{value}} of your {{objects}} was {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b><br><a onclick="logInfoClick(this);" class="infoLink" href="https://www.rescuetimecom/dashboard/for/the/day/of/{{cardDate}}" target="_blank" style="color:{{colour}}"><i class="fa fa-info-circle"></i> More info at RescueTime.com</a>',p="{{value}} {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b>",c="{{value}} {{objects}} {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b>{{eventDate}}</b>",u="<br><b>{{eventDate}}</b>{{value}} {{{objects}}} {{{action_pp}}} {{{property}}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}",l={eventDate:stripAtDetail(dateRangetext(e.startRange,e.endRange)),comparitor:createComparitorText(e.position,e.type),eventPeriod:"a day",comparisonPeriod:"",colour:t},d=buildPropertiesTextAndGetValue(e.properties.sum);"commit"===e.actionTags[0]||"push"===e.actionTags[1]?e.properties.sum.__count__?(l.action_pl=displayTags(pluralise(e.actionTags)),r=a.supplant(l)):(l.action_pp=displayTags(pastParticiple(e.actionTags)),l.property=d.propertiesText,r=o.supplant(l)):"listen"===e.actionTags[0]?e.properties.sum.__count__?(l.action_pl=displayTags(pluralise(e.actionTags)),l.objects=displayTags(e.objectTags),r=i.supplant(l)):(l.action_pl=displayTags(pluralise(e.actionTags)),l.property=d.propertiesText,l.value=d.value,r=n.supplant(l)):"use"===e.actionTags[0]?(l.property="&quot;"+d.propertiesText+"&quot;",l.objects=customFormatObjTags(displayTags(e.objectTags)),l.value=d.value,l.cardDate=e.cardDate,r=s.supplant(l)):"develop"===e.actionTags[0]?(e.chart.indexOf(".duration")>0?l.property="coding":l.property="coding sessions",l.value=d.value,r=p.supplant(l)):"exercise"===e.actionTags[0]?"walk"===e.actionTags[1]?(e.chart.indexOf("steps")>0?l.property=d.propertiesText:l.property="walks",l.value=d.value,r=p.supplant(l)):"ride"===e.actionTags[1]&&"distance.sum"===e.propertyName&&(l.property="metres ridden",l.value=d.value,r=p.supplant(l)):"browse"===e.actionTags[0]&&e.chart.indexOf("times-visited")>0&&(l.property=d.propertiesText,l.value=d.value,l.objects=customFormatObjTags(displayTags(e.objectTags)),r=c.supplant(l)),""===r&&(l.property=d.propertiesText,l.action_pp=displayTags(pastParticiple(e.actionTags)),l.objects=displayTags(e.objectTags),l.value=d.value,r=u.supplant(l)),r=r.supplant(l),e.cardText=r}}function buildPropertiesTextAndGetValue(e){for(var t="",r=Object.keys(e)[0],a,o=0,i={},n=!1,s=!1;r&&"__count__"!==r;){var p=unhyphenate(customFormatProperty(r));e=e[r],a=r,r.indexOf("duration")>=0?n=!0:r.indexOf("percent")>=0&&(s=!0),r="object"==typeof e?Object.keys(e)[0]:null,""!==p&&(t+=p,r&&"__count__"!==r&&(t+=": ")),o++}return i.propertiesText=t.trim(),"__count__"===r?i.value=e[r]:i.value=e,n?i.value<60?i.value=setPrecision(i.value)+" seconds":i.value=moment.duration(i.value,"seconds").humanize():s&&(i.value=setPrecision(i.value)+"%"),i}function createComparitorText(e,t){var r="";return r="top10"===t?"most":"fewest",e>0&&(r=ordinal_suffix_of(e+1,!0)+" "+r),r}function pluralise(e){var t=[];for(var r in e){var a;a="push"===e[r]?"es":"s",t.push(e[r]+a)}return t}function pastParticiple(e){var t=[];for(var r in e){var a;a="commit"===e[r]?"ted":"s",t.push(e[r]+a)}return t}function unhyphenate(e){return e.replace(/\^/g,".").replace(/-/g," ")}function customFormatProperty(e){return"artist-name"===e?"":"album-name"===e?"tracks from the album":e.indexOf("percent")>=0?e.replace("percent","").trim():e.indexOf("duration")>=0?e.replace("duration","").trim():e.indexOf("times-visited")>=0?e.replace("times-visited","visits").trim():e}function customFormatObjTags(e){return"computer desktop"===e?"computer time":e}function setPrecision(e){for(var t=e.toPrecision(3)+"";t.indexOf(".")>=0&&("0"===t.charAt(t.length-1)||"."===t.charAt(t.length-1));)t=t.substring(0,t.length-1);return t}function stripAtDetail(e){return stringArr=e.split(" at "),stringArr[0]=stringArr[0].replace("Last ",""),stringArr[0]}function dateRangetext(e,t){var r,a=moment();return e===t?(e=moment(e),r=e.calendar()):(e=moment(e),t=moment(t),r=e.format("lll")+" - "+t.format("lll")),r}function setSourceElements(e){e.actionTags&&e.objectTags&&("use"===e.actionTags[0]?e.dataSource="rescue-time":"listen"===e.actionTags[0]?e.dataSource="last-fm":"exercise"===e.actionTags[0]?e.dataSource="google-fit":"browse"===e.actionTags[0]?e.dataSource="visit-counter":"develop"===e.actionTags[0]?e.dataSource="sublime":e.objectTags.indexOf("github")>=0?e.dataSource="github":e.dataSource="unknown-data-source")}function renderThumbnailMedia(e,t){if(t.thumbnailMedia){var r=t.thumbnailMedia;r+="?lineColour="+stripHash(getColour(t.colourIndex)),r+="&highlightCondition="+t.type,r+="&highlightDates="+getHighlightDates(t),r+="&doTransitions=true",r+="&dataSrc="+encodeURIComponent(API_HOST+t.chart),e.find(".chart-iframe").attr("src",r)}}String.prototype.supplant=function(e){return this.replace(/\{\{([^{}]*)\}\}/g,function(t,r){var a=e[r];return"string"==typeof a||"number"==typeof a?a:t})};