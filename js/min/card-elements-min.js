function createCardText(e,t){var a="";if("top10"===e.type||"bottom10"===e.type){var r='{{comparitor}} {{action_pl}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b>',o='{{comparitor}} {{action_pp}} {{property}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b>',i='{{comparitor}} {{objects}} {{action_pl}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b>',n='{{value}} {{action_pl}} to {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b>',s='{{value}} of your {{objects}} was {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b><br><a onclick="logInfoClick(this);" class="infoLink" href="https://www.rescuetimecom/dashboard/for/the/day/of/{{cardDate}}" target="_blank" style="color:{{colour}}"><i class="fa fa-info-circle"></i> More info at RescueTime.com</a>',p='{{value}} {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b>',c='{{value}} {{objects}} {{property}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}<br><b class="event-date" >{{eventDate}}</b>',u='<br class="event-date" ><b>{{eventDate}}</b>{{value}} {{{objects}}} {{{action_pp}}} {{{property}}}<br>Your {{comparitor}} in {{eventPeriod}} {{comparisonPeriod}}',l={eventDate:stripAtDetail(dateRangetext(e.startRange,e.endRange)),comparitor:createComparitorText(e.position,e.type),eventPeriod:"a day",comparisonPeriod:"",colour:t},d=buildPropertiesTextAndGetValue(e.properties.sum);"commit"===e.actionTags[0]||"push"===e.actionTags[1]?e.properties.sum.__count__?(l.action_pl=displayTags(pluralise(e.actionTags)),a=r.supplant(l)):(l.action_pp=displayTags(pastParticiple(e.actionTags)),l.property=d.propertiesText,a=o.supplant(l)):"listen"===e.actionTags[0]?e.properties.sum.__count__?(l.action_pl=displayTags(pluralise(e.actionTags)),l.objects=displayTags(e.objectTags),a=i.supplant(l)):(l.action_pl=displayTags(pluralise(e.actionTags)),l.property=d.propertiesText,l.value=d.value,a=n.supplant(l)):"use"===e.actionTags[0]?(l.property="&quot;"+d.propertiesText+"&quot;",l.objects=customFormatObjTags(displayTags(e.objectTags)),l.value=d.value,l.cardDate=e.cardDate,a=s.supplant(l)):"develop"===e.actionTags[0]?(e.chart.indexOf(".duration")>0?l.property="coding":l.property="coding sessions",l.value=d.value,a=p.supplant(l)):"exercise"===e.actionTags[0]?"walk"===e.actionTags[1]?(e.chart.indexOf("steps")>0?l.property=d.propertiesText:l.property="walks",l.value=d.value,a=p.supplant(l)):"ride"===e.actionTags[1]&&"distance.sum"===e.propertyName&&(l.property="metres ridden",l.value=d.value,a=p.supplant(l)):"browse"===e.actionTags[0]&&e.chart.indexOf("times-visited")>0&&(l.property=d.propertiesText,l.value=d.value,l.objects=customFormatObjTags(displayTags(e.objectTags)),a=c.supplant(l)),""===a&&(l.property=d.propertiesText,l.action_pp=displayTags(pastParticiple(e.actionTags)),l.objects=displayTags(e.objectTags),l.value=d.value,a=u.supplant(l)),a=a.supplant(l),e.cardText=a}}function buildPropertiesTextAndGetValue(e){for(var t="",a=Object.keys(e)[0],r,o=0,i={},n=!1,s=!1;a&&"__count__"!==a;){var p=unhyphenate(customFormatProperty(a));e=e[a],r=a,a.indexOf("duration")>=0?n=!0:a.indexOf("percent")>=0&&(s=!0),a="object"==typeof e?Object.keys(e)[0]:null,""!==p&&(t+=p,a&&"__count__"!==a&&(t+=": ")),o++}return i.propertiesText=t.trim(),"__count__"===a?i.value=e[a]:i.value=e,n?i.value<60?i.value=setPrecision(i.value)+" seconds":i.value=moment.duration(i.value,"seconds").humanize():s&&(i.value=setPrecision(i.value)+"%"),i}function createComparitorText(e,t){var a="";return a="top10"===t?"most":"fewest",e>0&&(a=ordinal_suffix_of(e+1,!0)+" "+a),a}function pluralise(e){var t=[];for(var a in e){var r;r="push"===e[a]?"es":"s",t.push(e[a]+r)}return t}function pastParticiple(e){var t=[];for(var a in e){var r;r="commit"===e[a]?"ted":"s",t.push(e[a]+r)}return t}function unhyphenate(e){return e.replace(/\^/g,".").replace(/-/g," ")}function customFormatProperty(e){return"artist-name"===e?"":"album-name"===e?"tracks from the album":e.indexOf("percent")>=0?e.replace("percent","").trim():e.indexOf("duration")>=0?e.replace("duration","").trim():e.indexOf("times-visited")>=0?e.replace("times-visited","visits").trim():e}function customFormatObjTags(e){return"computer desktop"===e?"computer time":e}function setPrecision(e){for(var t=e.toPrecision(3)+"";t.indexOf(".")>=0&&("0"===t.charAt(t.length-1)||"."===t.charAt(t.length-1));)t=t.substring(0,t.length-1);return t}function stripAtDetail(e){return stringArr=e.split(" at "),stringArr[0]=stringArr[0].replace("Last ",""),stringArr[0]}function dateRangetext(e,t){var a,r=moment();return e===t?(e=moment(e),a=e.calendar()):(e=moment(e),t=moment(t),a=e.format("lll")+" - "+t.format("lll")),a}function setSourceElements(e){e.actionTags&&e.objectTags&&("use"===e.actionTags[0]?e.dataSource="rescue-time":"listen"===e.actionTags[0]?e.dataSource="last-fm":"exercise"===e.actionTags[0]?e.dataSource="google-fit":"browse"===e.actionTags[0]?e.dataSource="visit-counter":"develop"===e.actionTags[0]?e.dataSource="sublime":e.objectTags.indexOf("github")>=0?e.dataSource="github":e.dataSource="unknown-data-source")}function renderThumbnailMedia(e,t){if(t.thumbnailMedia){var a=t.thumbnailMedia;a+="?lineColour="+stripHash(getColour(t.colourIndex)),a+="&highlightCondition="+t.type,a+="&highlightDates="+getHighlightDates(t),a+="&doTransitions=true",a+="&dataSrc="+encodeURIComponent(API_HOST+t.chart),e.find(".chart-iframe").attr("src",a)}}String.prototype.supplant=function(e){return this.replace(/\{\{([^{}]*)\}\}/g,function(t,a){var r=e[a];return"string"==typeof r||"number"==typeof r?r:t})};